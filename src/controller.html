<!DOCTYPE html>
<html>

<head>
  <title>Ponk Controller</title>
  <style>
    .garden {
      position: relative;
      width: 200px;
      height: 200px;
      border: 5px solid #ccc;
      border-radius: 10px;
    }

    .paddle {
      position: absolute;
      top: 90px;
      left: 0px;
      width: 1px;
      height: 5px;
      background: green;
    }
  </style>
</head>

<body>
  <h1>Controller!</h1>
  <div class="garden">
    <div class="paddle"></div>
  </div>

  <pre class="output"></pre>


  <script>
    const paddle = document.querySelector(".paddle");
    const garden = document.querySelector(".garden");
    const output = document.querySelector(".output");

    const maxX = garden.clientWidth - paddle.clientWidth;
    const maxY = garden.clientHeight - paddle.clientHeight;

    function handleOrientation(event) {
      const landscape = window.screen.orientation.type.startsWith('landscape');
      let y = 0;
      let x = (landscape ? event.beta : event.gamma) * 2;

      output.textContent = `x: ${x}\n`;
      output.textContent += `y: ${y}\n`;
      output.textContent += `orientation: ${window.screen.orientation.type}, ${window.screen.orientation.angle}\n`;

      // Because we don't want to have the device upside down
      // We constrain the x value to the range [-90,90]
      if (x > 90) {
        x = 90;
      }
      if (x < -90) {
        x = -90;
      }

      // To make computation easier we shift the range of
      // x and y to [0,180]
      x += 90;
      y += 90;

      // 10 is half the size of the paddle
      // It center the positioning point to the center of the paddle
      paddle.style.top = `${(maxY * y) / 180 + 10}px`;
      paddle.style.left = `${(maxX * x) / 180}px`;
    }

    window.addEventListener("deviceorientation", handleOrientation);
  </script>
</body>

</html>
